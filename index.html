<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Minimal News Aggregator</title>
  <style>
    body { font-family: sans-serif; margin: 20px; line-height: 1.4; }
    h1 { font-size: 22px; margin-bottom: 10px; }
    h2 { font-size: 18px; margin-top: 30px; }
    ul { padding-left: 18px; }
    li { margin-bottom: 6px; }
    .timestamp { color: #666; font-size: 12px; margin-left: 6px; }
  </style>
</head>
<body>
  <h1>Minimal News Aggregator</h1>
  <div id="content">Loading...</div>

  <script>
    const feeds = [
      { name: "Fierce Pharma", url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.fiercepharma.com/rss" },
      { name: "Pharma Executive", url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.pharmexec.com/rss" },
      { name: "BioSpace", url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.biospace.com/rss/" },
      { name: "PhRMA", url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.phrma.org/feed" },
      { name: "Fierce Biotech", url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.fiercebiotech.com/rss" }
    ];

    function parseDate(d) {
      if (!d) return "";
      const dt = new Date(d);
      if (isNaN(dt)) return "";
      return dt.toLocaleString();
    }

    async function loadFeeds() {
      const allArticles = [];

      for (const feed of feeds) {
        try {
          const res = await fetch(feed.url);
          const data = await res.json();

          data.items.forEach(item => {
            allArticles.push({
              source: feed.name,
              title: item.title,
              link: item.link,
              published: item.pubDate || item.published || "",
            });
          });
        } catch (e) {
          console.error("Error loading:", feed.name);
        }
      }

      allArticles.sort((a, b) => new Date(b.published) - new Date(a.published));

      const container = document.getElementById("content");
      container.innerHTML = "";

      const section = document.createElement("div");
      const list = document.createElement("ul");

      allArticles.slice(0, 50).forEach(item => {
        const li = document.createElement("li");
        const a = document.createElement("a");
        a.href = item.link;
        a.textContent = `[${item.source}] ${item.title}`;
        a.target = "_blank";

        const ts = document.createElement("span");
        ts.className = "timestamp";
        ts.textContent = parseDate(item.published);

        li.appendChild(a);
        li.appendChild(ts);
        list.appendChild(li);
      });

      section.appendChild(list);
      container.appendChild(section);
    }

    loadFeeds();
    setInterval(loadFeeds, 5 * 60 * 1000);
  </script>
</body>
</html>
